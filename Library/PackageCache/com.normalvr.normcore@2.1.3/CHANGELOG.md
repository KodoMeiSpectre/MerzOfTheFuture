# Normcore Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/) and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [2.1.3] - 2020-03-26

### Fixed
- Remove log level DLL variants that were preventing Unity from building on Android.

## [2.1.2] - 2020-03-25

### Fixed
- Fix infinite recursion in `RealtimeViewEditor`.

## [2.1.1] - 2020-03-25

### Fixed
- Fix native bundle issue on Mac.

## [2.1.0] - 2020-03-25

### Added
- Add `RealtimeModel#room` and `RealtimeModel#isRoomConnected` getters for easier room access from models.
- Add `RealtimeView#isPrefabView` and `RealtimeView#isSceneView` getters for checking child views.
- Add `RealtimeView#GetParentView()` and `RealtimeView#GetRootView()` for finding the parent/root views of a view.
- Add `TryGetValue`, `ContainsKey`, and `Contains` to RealtimeDictionary.
- Add `destroyWhenOwnerLeaves` and `destroyWhenLastClientLeaves` to `RealtimeView` and `RealtimeModel`.
- Add new `Realtime.Instantiate` signature with `Realtime.InstantiateOptions` parameter.
- Add error log when lifetime flags are modified on a model with no meta-model.
- Add `joinRoomOnStart` and `roomToJoinOnStart` getters so that applications can query whether `Realtime` is configured to join a room on start.
- Add "Destroy" button to the RealtimeView inspector on the root realtime view of a prefab to make it easier to clean up persistent realtime prefabs.
- Add multi-object editing support to the RealtimeTransform inspector.
- Add inline documentation to all public C# APIs and include XML docs file for C# IDEs.
- Add `IRealtimePrefabLoadDelegate` and `IRealtimePrefabInstantiateDelegate` interfaces to support hooking realtime prefab loading and instantiation.
- Add property serializer classes to simplify autogenerated model code and improve memory/performance.

### Changed
- Change `Realtime#Connect` to go into an error state if the room name or app key is empty.
- Update `RealtimeAvatarVoice` to automatically request microphone permissions on Android.
- Change `RealtimeModel#isPersistent` to use current ownership to determine if it is persistent.
- Realtime collections now throw an error if the child model already exists in the datastore.
- Unsupported versions of `Realtime.Instantiate` and `Realtime.Destroy` now create compiler errors.
- Deprecate `Realtime.Instantiate` overloads that use `destroyWhenOwnerOrLastClientLeaves`.
- Deprecate `destroyWhenOwnerOrLastClientLeaves`, which can cause a scene view to be destroyed while clients are still in the room. The property has been split into `destroyWhenOwnerLeaves` and `destroyWhenLastClientLeaves`. Old clients setting the deprecated property will still work, but they will not see changes from the new properties. Use the new `Realtime.Instantiate` method signature to instantiate prefabs with the split lifetime flags.

### Fixed
- Fix issue with `RealtimeView#destroyWhenOwnerOrLastClientLeaves` not forwarding the setter to the model.
- Fix issue with high CPU usage in `RealtimeAvatarVoice` on Quest and Quest 2.
- Fix issue with `RealtimeSet` where serializing a newly created collection for the first time will only send one item to the server.
- Fix issue where `RealtimeView` on a deeply nested game object could end up as the child to two parent views.
- Fix `StringKeyDictionary` enumerator signature to iterate through string keys instead of internal ID keys.
- Fix issue where calling `Realtime#Connect` inside of `Realtime#didConnectToRoom` event handler would crash Unity.
- Fix issue where datastore snapshots larger than 125kb would prevent a new client from connecting to a room.
- Fix issue where `Realtime` would try to destroy null game objects after scene unloads.
- Fix issue where Normcore 1 migration window would show on new projects.
- Fix `SimpleJSON` to use all `System` namespace types explicitly to avoid conflicts if a type with the same name is defined in the global namespace.
- Fix issue in native plug-in that would cause occasional crashes on macOS when connecting to a room.
- Fix issue where the internal settings asset would throw an exception while the asset database was loading.
- Fix warning in RealtimeAvatarManager about using deprecated API.

### Removed
- Remove public parent constructor from autogenerated `RealtimeModel` code.

## [2.0.3] - 2020-11-13

### Fixed
- Fix exception on `RealtimeSet#modelRemoved` when event is null.
- Fix issue introduced in 2.0.2 with `RealtimeTransform` on scene views not initializing correctly.

## [2.0.2] - 2020-11-09

### Added
- Add `preventOwnershipTakeover` and `destroyWhenOwnerOrLastClientLeaves` properties to `RealtimeView`.
- Add support for macOS 10.13 & 10.14 (High Sierra & Mojave).
- Notarize native plugin on macOS.

### Fixed
- Add Lumin SDK to list of supported platforms for native plugin to fix Magic Leap support.
- Fix null `realtimeView` references on disabled game objects.

## [2.0.1] - 2020-10-26

### Added
- Add "Never Ask Again" option when Normcore alerts you to a new version.

### Fixed
- Fix thread error when a `RealtimeTransform` is garbage collected off the main thread.

## [2.0.0] - 2020-10-16
Initial changelog release.
